<nz-page-header
    [nzBackIcon]="'arrow-left'"
>
    <nz-page-header-title><div contenteditable>Безымянный</div></nz-page-header-title>
    <nz-page-header-subtitle>Информационное дополнение</nz-page-header-subtitle>
    <nz-page-header-extra>
        <nz-space>
            <button *nzSpaceItem nz-button>
                <span nz-icon [nzType]="'expand'" nzTheme="outline"></span>
            </button>
            <button *nzSpaceItem nz-button nzType="primary">
                <span nz-icon nzType="save"></span>
                Сохранить
            </button>
            <div *nzSpaceItem>
                <button
                    nz-button
                    nzNoAnimation
                    nz-dropdown
                    [nzDropdownMenu]="menu"
                    nzPlacement="bottomRight"
                    style="padding: 0"
                >
                    <span nz-icon nzType="more" nzTheme="outline" style="font-size: 18px; vertical-align: top;"></span> 
                </button>
                <nz-dropdown-menu #menu="nzDropdownMenu">
                    <ul nz-menu>
                        <li nz-menu-item nzWarning>
                            <span nz-icon nzType="reload"></span>
                            Сбросить к началу
                        </li>
                        <li nz-menu-item nzDanger>
                            <span nz-icon nzType="delete"></span>
                            Удалить
                        </li>
                    </ul>
                </nz-dropdown-menu>
            </div>
        </nz-space>
    </nz-page-header-extra>
</nz-page-header>
<nz-content>
    <div
        class="bi-metalayer"
    >
        <div class="inner-content bi-metalayer-sources">
            <div class="bi-sources-header">
                <strong><span nz-icon nzType="database" nzTheme="outline"></span> Источники</strong>
            </div>
            <div class="bi-sources-select">
                <nz-select nzShowSearch nzPlaceHolder="Выбирите источник" [nzSize]="'small'">
                    <nz-option nzLabel="Название источника данных 1" nzValue="1"></nz-option>
                    <nz-option nzLabel="Название источника данных 2" nzValue="2"></nz-option>
                    <nz-option nzLabel="Название источника данных 3" nzValue="3"></nz-option>
                </nz-select>
            </div>
            <div class="bi-sources">
                <div class="bi-sources-search">
                    <nz-input-group [nzSuffix]="suffixIconSearch" nzSize="small">
                        <input type="text" nz-input placeholder="Поиск в слоях"/>
                    </nz-input-group>
                    <ng-template #suffixIconSearch nzSize="small">
                        <span nz-icon nzType="search"></span>
                    </ng-template>
                </div>
                <div class="bi-sources-list">
                    <nz-tree [nzData]="nodes" nzShowLine (nzClick)="nzEvent($event)"></nz-tree>
                </div>
            </div>
        </div>

        <div class="inner-content bi-metalayer-table">
            <nz-space
                [ngStyle]="{
                    'width': '100%',
                    'justify-content': 'space-between'
                }"
            >
                <strong *nzSpaceItem>
                    Название таблицы
                </strong>
                <button *nzSpaceItem nz-button nzType="text" nzSize="small">
                    <span nz-icon nzType="close" nzTheme="outline"></span>
                </button>
            </nz-space>
            <nz-divider [ngStyle]="{'margin': '8px 0'}"></nz-divider>
            <div>
                Место для таблицы
            </div>
        </div>
        <div class="inner-content bi-metalayer-semantic">
            <div class="bi-semantic-header">
                <strong><span nz-icon nzType="container" nzTheme="outline"></span> Семантические слои</strong>
                <!-- <button
                    nz-button
                    nzNoAnimation
                    nz-dropdown
                    [nzDropdownMenu]="menu"
                    nzPlacement="bottomRight"
                    nzTrigger="click"
                    nzType="text"
                    nzSize="small"
                >
                    <span nz-icon nzType="plus" nzTheme="outline"></span> 
                </button>
                <nz-dropdown-menu #menu="nzDropdownMenu">
                    <nz-card
                        nz-menu
                        style="width:256px;"
                        nzSize="small"
                    >
                        <nz-form-control>
                            <nz-form-label nzFor="layer-name" nzSize="small"><strong>Название</strong></nz-form-label>
                            <input id="layer-name" nz-input placeholder="Название слоя" nzSize="small"/>
                        </nz-form-control>
                        <nz-divider [ngStyle]="{'margin': '8px 0'}"></nz-divider>
                        <div
                            nz-flex
                            [nzJustify]="'space-between'"
                            [nzAlign]="'center'"
                        >
                            <button nz-button nzType="default" nzSize="small">Отменить</button>
                            <button nz-button nzType="primary" nzSize="small">
                                <span nz-icon nzType="plus"></span> Добавить
                            </button>
                        </div>

                    </nz-card>
                </nz-dropdown-menu> -->
            </div>
            <div class="bi-semantic-select">

                <div
                    [ngStyle]="{
                        'display': 'flex',
                        'align-items': 'center',
                        'gap': '8px'
                    }"
                >
                    <div
                        [ngStyle]="{
                            'flex-grow': '1'
                        }"
                    >
                    <nz-select
                        nzShowSearch
                        nzPlaceHolder="Выбирите слой"
                        nzSize="small"
                        style="width:100%;"
                    >
                        <nz-option nzLabel="Название слой данных 1" nzValue="1"></nz-option>
                        <nz-option nzLabel="Название слой данных 2" nzValue="2"></nz-option>
                        <nz-option nzLabel="Название слой данных 3" nzValue="3"></nz-option>
                    </nz-select>
                    </div>
                    <div>
                    <button
                        nz-button
                        nzNoAnimation
                        nz-dropdown
                        [nzDropdownMenu]="menu"
                        nzPlacement="bottomRight"
                        nzTrigger="click"
                        nzSize="small"
                    >
                        <span nz-icon nzType="plus" nzTheme="outline"></span> 
                    </button>
                    <nz-dropdown-menu #menu="nzDropdownMenu">
                        <nz-card
                            nz-menu
                            style="width:256px;"
                            nzSize="small"
                        >
                            <nz-form-control>
                                <nz-form-label nzFor="layer-name" nzSize="small"><strong>Название</strong></nz-form-label>
                                <input id="layer-name" nz-input placeholder="Название слоя" nzSize="small"/>
                            </nz-form-control>
                            <nz-divider [ngStyle]="{'margin': '8px 0'}"></nz-divider>
                            <div
                                nz-flex
                                [nzJustify]="'space-between'"
                                [nzAlign]="'center'"
                            >
                                <button nz-button nzType="default" nzSize="small">Отменить</button>
                                <button nz-button nzType="primary" nzSize="small">
                                    <span nz-icon nzType="plus"></span> Добавить
                                </button>
                            </div>
                        </nz-card>
                    </nz-dropdown-menu>
                    </div>
                </div>
                    
            </div>
            <div class="bi-semantic">
                <div class="bi-semantic-search">
                    <nz-input-group [nzSuffix]="suffixIconSearch" nzSize="small">
                        <input type="text" nz-input placeholder="Поиск в источнике"/>
                    </nz-input-group>
                    <ng-template #suffixIconSearch nzSize="small">
                        <span nz-icon nzType="search"></span>
                    </ng-template>
                </div>
                <div class="bi-semantic-list">
                    <nz-tree [nzData]="nodes" nzShowLine (nzClick)="nzEvent($event)"></nz-tree>
                </div>
            </div>
        </div>
        <div class="bi-metalayer-editor">

            <!-- Связи - начало -->
            <button
                (click)="showModalLink()"
                nz-button nzType="default" [nzSize]="'small'" nzShape="circle"
            >
                <span nz-typography nzType="secondary">
                    <span nz-icon nzType="link"></span>
                </span>
            </button>
            <!-- <br><br><br>
            <button
                nz-button nzType="default" [nzSize]="'small'" nzShape="circle"
                nz-popconfirm
                nzPopconfirmTitle="Are you sure delete this task?"
                nzPopconfirmPlacement="bottom"
                (nzOnConfirm)="confirm()"
                (nzOnCancel)="cancel()"
            >
                <span nz-typography nzType="danger">
                    <span nz-icon nzType="close"></span>
                </span>
            </button> -->



            <nz-modal
                (nzOnOk)="handleModalLinkOk()"
                (nzOnCancel)="handleModalLinkCancel()"
                [(nzVisible)]="isModalLinkVisible"
                nzCentered
                nzWidth="720px"
                nzTitle="Связи"
            >
                <ng-container *nzModalContent>

                    <!-- Таблица - начало -->
                    <nz-space nzDirection="vertical">
                        <div
                            *nzSpaceItem
                            nz-flex
                            [nzJustify]="'space-between'"
                            [nzAlign]="'center'"
                        >
                            <span>
                                Всего записей <b>1</b>
                            </span>
                            <button
                                nz-button nzType="default" [nzSize]="'small'" nzType="link"
                            ><span nz-icon nzType="plus"></span> Добавить запись</button>
                        </div>
                        <nz-table
                            *nzSpaceItem
                            nzSize="small"
                            #basicTable
                            [nzData]="person"
                            nzTableLayout="fixed"
                        >
                            <thead>
                                <tr>
                                    <th>Левая</th>
                                    <th>Тип</th>
                                    <th>Правая</th>
                                    <th style="width: 120px;">Вкл.</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <nz-select ngModel="2" [nzSize]="'small'" style="width: 100%;">
                                            <nz-option nzValue="1" nzLabel="ID чего-то"></nz-option>
                                            <nz-option nzValue="2" nzLabel="ID чего-то еще"></nz-option>
                                        </nz-select>
                                    </td>
                                    <td>
                                        <nz-select ngModel="2" [nzSize]="'small'" style="width: 100%;">
                                            <nz-option nzValue="1" nzLabel="Такая-то"></nz-option>
                                            <nz-option nzValue="2" nzLabel="Сякая-то"></nz-option>
                                        </nz-select>
                                    </td>
                                    <td>
                                        <nz-select ngModel="1" [nzSize]="'small'" style="width: 100%;">
                                            <nz-option nzValue="1" nzLabel="ID чего-то"></nz-option>
                                            <nz-option nzValue="2" nzLabel="ID чего-то еще" nzDisabled></nz-option>
                                        </nz-select>
                                    </td>
                                    <td>
                                        <div
                                            nz-flex
                                            [nzJustify]="'space-between'"
                                        >
                                            <div>
                                                <nz-switch nzSize="small" [ngModel]="true"></nz-switch>
                                                <nz-divider nzType="vertical"></nz-divider>
                                            </div>
                                            <div>
                                                <button nz-button nzType="link" [nzSize]="'small'">
                                                    <span nz-icon nzType="edit"></span>
                                                </button>
                                                <button nz-button nzType="link" [nzSize]="'small'">
                                                    <span nz-icon nzType="delete"></span>
                                                </button>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr *ngFor="let data of basicTable.data">
                                    <td>{{ data.name }}</td>
                                    <td>{{ data.age }}</td>
                                    <td>{{ data.address }}</td>
                                    <td>{{ data.name }}</td>
                                </tr>
                            </tbody>
                        </nz-table>
                    </nz-space>
                    <!-- Таблица - конец -->

                </ng-container>
            </nz-modal>
            <!-- Связи - конец -->

        </div>
    </div>    
</nz-content>